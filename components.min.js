function initHomeSlider(scope){if(window.innerWidth<1024)return;const root=scope||document,thumbs=Array.from(root.querySelectorAll(".work_thumb_wrap")),slides=Array.from(root.querySelectorAll(".work_slide")),divider=root.querySelector(".work_thumb_divider");let zIndexCounter=10,activeIndex=0,isClicked=!1;function disableAllThumbs(){console.log("=== DISABLE ALL THUMBS CALLED ==="),console.log("isClicked was:",isClicked),console.log("activeIndex:",activeIndex),console.log("thumbs count:",thumbs.length),console.log("slides count:",slides.length),console.log("thumbs array:",thumbs),console.log("slides array:",slides),isClicked=!0,thumbs.forEach((thumb,index)=>{if(index!==activeIndex){const workThumbLinks=thumb.querySelectorAll(".work_thumb a"),allLinks=thumb.querySelectorAll("a");workThumbLinks.forEach(link=>{link.style.pointerEvents="none"}),allLinks.forEach(link=>{link.style.pointerEvents="none"})}}),slides.forEach((slide,index)=>{console.log(`Processing slide ${index}, activeIndex: ${activeIndex}`),index!==activeIndex?(gsap.to(slide,{opacity:0,duration:.1,ease:"power2.out",onComplete:()=>{slide.style.display="none",console.log(`Slide ${index} display set to none`)}}),console.log(`Slide ${index} made transparent and hidden`)):console.log(`Skipping active slide ${index}`)}),console.log("=== DISABLE ALL THUMBS COMPLETED ==="),barbaLog("All work_thumb_wrap elements disabled after click")}thumbs.length&&slides.length&&divider&&(slides.forEach((slide,i)=>{const img=slide.querySelector(".work_slide_img");img&&(img.style.opacity=0===i?"1":"0");const info=slide.querySelector(".work_slide_info");info&&(info.style.opacity=0===i?"1":"0")}),slides[0].style.zIndex=zIndexCounter++,slides[0].style.clipPath="inset(0% 0% 0% 0%)",thumbs[0].appendChild(divider),thumbs.forEach((thumb,i)=>{thumb.addEventListener("mousedown",e=>{console.log(`=== MOUSEDOWN ON THUMB ${i} ===`),console.log("isClicked:",isClicked),e.preventDefault(),e.stopPropagation(),disableAllThumbs()}),thumb.addEventListener("click",e=>{console.log(`=== CLICK ON THUMB ${i} ===`),console.log("isClicked:",isClicked),e.preventDefault(),e.stopPropagation(),disableAllThumbs()}),thumb.addEventListener("mouseenter",()=>{if(isClicked||activeIndex===i)return;const slide=slides[i],prevSlide=slides[activeIndex];"none"===slide.style.display&&(slide.style.display="",gsap.set(slide,{opacity:1})),slides.forEach((slideItem,j)=>{slideItem.style.zIndex=j===i?zIndexCounter++:1}),gsap.fromTo(slide,{clipPath:"inset(100% 0% 0% 0%)",autoAlpha:1},{clipPath:"inset(0% 0% 0% 0%)",duration:1.4,ease:"expo.out",overwrite:!0});const img=slide.querySelector(".work_slide_img");img&&(gsap.set(img,{opacity:1}),gsap.fromTo(img,{scale:1.3},{scale:1,duration:1.2,ease:"expo.out",overwrite:!0}));const info=slide.querySelector(".work_slide_info");info&&gsap.fromTo(info,{opacity:0},{opacity:1,duration:.6,delay:.2,ease:"expo.out",overwrite:!0});slide.querySelectorAll('[work-slide-component="badge"]').forEach((badge,b)=>{gsap.fromTo(badge,{opacity:1,y:0},{opacity:1,y:0,duration:1.2,delay:.06*b,ease:"expo.out",overwrite:!0})});const state=Flip.getState(divider);if(thumbs[i].appendChild(divider),Flip.from(state,{duration:.6,ease:"expo.out"}),activeIndex!==i&&prevSlide){const prevImg=prevSlide.querySelector(".work_slide_img");prevImg&&gsap.to(prevImg,{opacity:0,duration:.9,ease:"expo.out",overwrite:!0});const prevInfo=prevSlide.querySelector(".work_slide_info");prevInfo&&gsap.to(prevInfo,{opacity:0,duration:.9,ease:"expo.out",overwrite:!0})}activeIndex=i}),thumb.addEventListener("mouseleave",()=>{isClicked&&activeIndex===i||setTimeout(()=>{const isAnyHovered=thumbs.some(t=>t.matches(":hover"));if(activeIndex===i)if(isAnyHovered){slides[i].style.zIndex=1,gsap.to(slides[i],{clipPath:"inset(0% 0% 100% 0%)",duration:1.4,ease:"expo.out",overwrite:!0});const img=slides[i].querySelector(".work_slide_img");img&&gsap.to(img,{opacity:0,duration:1,ease:"expo.out",overwrite:!0});const info=slides[i].querySelector(".work_slide_info");info&&gsap.to(info,{opacity:0,duration:.4,delay:0,ease:"expo.out",overwrite:!0})}else{const targetIndex=0,targetSlide=slides[targetIndex];"none"===targetSlide.style.display&&(targetSlide.style.display="",gsap.set(targetSlide,{opacity:1})),slides.forEach((slideItem,j)=>{slideItem.style.zIndex=j===targetIndex?zIndexCounter++:1}),gsap.to(targetSlide,{clipPath:"inset(0% 0% 0% 0%)",duration:1.4,ease:"expo.out",overwrite:!0});const targetImg=targetSlide.querySelector(".work_slide_img");targetImg&&gsap.to(targetImg,{opacity:1,duration:.9,ease:"expo.out",overwrite:!0});const targetInfo=targetSlide.querySelector(".work_slide_info");if(targetInfo&&gsap.to(targetInfo,{opacity:1,duration:.9,ease:"expo.out",overwrite:!0}),i!==targetIndex){const currentImg=slides[i].querySelector(".work_slide_img");currentImg&&gsap.to(currentImg,{opacity:0,duration:.9,ease:"expo.out",overwrite:!0});const currentInfo=slides[i].querySelector(".work_slide_info");currentInfo&&gsap.to(currentInfo,{opacity:0,duration:.9,ease:"expo.out",overwrite:!0})}const state=Flip.getState(divider);thumbs[targetIndex].appendChild(divider),Flip.from(state,{duration:.6,ease:"expo.out"}),activeIndex=targetIndex}},10)})),slides.forEach((slide,index)=>{slide.addEventListener("mousedown",e=>{console.log(`=== MOUSEDOWN ON SLIDE ${index} ===`),console.log("isClicked:",isClicked),e.preventDefault(),e.stopPropagation(),disableAllThumbs()}),slide.addEventListener("click",e=>{console.log(`=== CLICK ON SLIDE ${index} ===`),console.log("isClicked:",isClicked),e.preventDefault(),e.stopPropagation(),disableAllThumbs()})}))}function initNav(scope){if(window.innerWidth<1024)return;const root=scope||document,nav=root.querySelector(".nav"),trigger=root.querySelector('[data-nav-reveal="trigger"]'),menuBg=root.querySelector(".menu-bg"),aboutContainer=root.querySelector(".about_container"),btnTexts=root.querySelectorAll('[data-nav-reveal="btn-text"]'),items=root.querySelectorAll('[data-nav-reveal="item"]'),paths=root.querySelectorAll('[data-nav-reveal="path"]'),pathPosters=root.querySelectorAll('[data-nav-reveal="path-poster"]'),imgs=root.querySelectorAll('[data-nav-reveal="img"]'),aboutTabs=root.querySelectorAll(".about-tab"),aboutPlanes=root.querySelectorAll(".about_plane"),tabDivider=root.querySelector(".tab_divider"),aboutMainPWrap=root.querySelector(".about_main-p_wrap");if(!nav||!trigger)return;trigger._navCleanup&&trigger._navCleanup(),gsap.set(nav,{height:"2.5rem"}),gsap.set(aboutContainer,{opacity:0}),gsap.set(btnTexts,{yPercent:0}),gsap.set(items,{opacity:0}),gsap.set(paths,{yPercent:0}),gsap.set(pathPosters,{yPercent:130}),gsap.set(imgs,{opacity:0}),gsap.set(aboutMainPWrap,{opacity:1}),aboutPlanes.forEach((plane,i)=>{plane.classList.toggle("is-active",0===i)});let navOpen=!1;function closeNav(){navOpen=!1,gsap.to(aboutContainer,{opacity:0,duration:.3,ease:"power1.out"}),gsap.to(btnTexts,{yPercent:0,duration:.6,ease:"expo.out"}),gsap.to(paths,{yPercent:0,from:{yPercent:100},duration:1,delay:.5,stagger:{amount:.15,from:"center"},ease:"expo.out"}),gsap.to(pathPosters,{yPercent:130,from:{yPercent:0},duration:.8,stagger:{amount:.12,from:"center"},ease:"expo.in"}),gsap.to(nav,{height:"2.5rem",duration:.5,ease:"expo.out"}),gsap.to(items,{opacity:0,duration:.3,ease:"power1.out"}),gsap.to(aboutMainPWrap,{opacity:1,duration:.3}),menuBg&&menuBg.classList.remove("active")}function toggleNav(){navOpen?closeNav():function openNav(){navOpen=!0,gsap.to(nav,{height:"80vh",duration:1.2,ease:"expo.inOut"}),gsap.to(aboutContainer,{opacity:1,duration:.5,delay:.45,ease:"power2.out"}),gsap.to(btnTexts,{yPercent:-100,duration:.8,ease:"expo.out"}),gsap.to(items,{opacity:1,duration:1,delay:.45,stagger:.1,ease:"power1.out"}),gsap.to(paths,{yPercent:-100,duration:1,delay:.45,stagger:{amount:.12,from:"center"},ease:"expo.out"}),gsap.to(pathPosters,{yPercent:0,from:{yPercent:130},duration:1.8,delay:.45,stagger:{amount:.18,from:"center"},ease:"expo.out"}),gsap.to(imgs,{opacity:1,duration:.4,delay:.8}),menuBg&&menuBg.classList.add("active"),setActiveTab(0,!0)}()}function handleClickOutside(e){navOpen&&!nav.contains(e.target)&&closeNav()}function handleTriggerClick(e){e.stopPropagation(),toggleNav()}function setActiveTab(idx,force=!1){if(aboutPlanes.forEach((plane,i)=>{plane.classList.toggle("is-active",i===idx)}),tabDivider&&aboutTabs[idx]){const state=Flip.getState(tabDivider);aboutTabs[idx].appendChild(tabDivider),Flip.from(state,{duration:.6,ease:"expo.out"})}0===idx||force?gsap.to(aboutMainPWrap,{opacity:1,duration:.3}):gsap.to(aboutMainPWrap,{opacity:0,duration:.3})}document.addEventListener("click",handleClickOutside),trigger.addEventListener("click",handleTriggerClick),aboutTabs.forEach((tab,idx)=>{tab.addEventListener("click",function(){setActiveTab(idx)})}),trigger._navCleanup=function(){document.removeEventListener("click",handleClickOutside),trigger.removeEventListener("click",handleTriggerClick),aboutTabs.forEach((tab,idx)=>{tab.removeEventListener("click",function(){setActiveTab(idx)})})},barbaLog("Nav initialized",{hasNav:!!nav,hasTrigger:!!trigger,hasAboutTabs:aboutTabs.length})}function initDropdown(scope){if(window.innerWidth<1024)return;const root=scope||document,dropdownBtn=root.querySelector(".dropdown_btn"),dropdownPopUp=root.querySelector(".dropdown_pop-up"),dropdownIcon=root.querySelector(".dropdown_icon"),popUpItems=root.querySelectorAll(".pop-up_item"),visualImgs=root.querySelectorAll(".dropdown_visual_img");function openDropdown(){dropdownPopUp.classList.add("opened"),dropdownIcon.classList.add("opened")}function closeDropdown(){dropdownPopUp.classList.remove("opened"),dropdownIcon.classList.remove("opened")}dropdownBtn&&dropdownPopUp&&(dropdownBtn._dropdownCleanup&&dropdownBtn._dropdownCleanup(),dropdownBtn.addEventListener("mouseenter",openDropdown),dropdownPopUp.addEventListener("mouseenter",openDropdown),dropdownBtn.addEventListener("mouseleave",closeDropdown),dropdownPopUp.addEventListener("mouseleave",closeDropdown),popUpItems.forEach((item,idx)=>{item.addEventListener("mouseenter",()=>{visualImgs.forEach(img=>{gsap.to(img,{opacity:0,duration:0})}),gsap.to(visualImgs[idx],{opacity:1,duration:0})}),item.addEventListener("mouseleave",()=>{gsap.to(visualImgs[idx],{opacity:0,duration:.3})})}),dropdownBtn._dropdownCleanup=function(){dropdownBtn.removeEventListener("mouseenter",openDropdown),dropdownPopUp.removeEventListener("mouseenter",openDropdown),dropdownBtn.removeEventListener("mouseleave",closeDropdown),dropdownPopUp.removeEventListener("mouseleave",closeDropdown),popUpItems.forEach((item,idx)=>{item.removeEventListener("mouseenter",()=>{}),item.removeEventListener("mouseleave",()=>{})})})}function initVisualSlider(scope){if(window.innerWidth<1024)return;const root=scope||document,$body=$("body",root),$lightbox=$(".visual_slider",root),$lightboxBg=$lightbox.find(".visual_slider_bg"),$sliderItems=$lightbox.find(".visual_img-wrap.is-slider"),$listItems=$(".visual_imgs_wrapper .visual_img-wrap",root),$closeBtn=$lightbox.find('[slider-cntrl="close"]'),$prevBtn=$lightbox.find('[slider-cntrl="prev"]'),$nextBtn=$lightbox.find('[slider-cntrl="next"]');let currentIndex=-1,$srcWrap=null,$srcImg=null,$lightboxItem=null,$lightboxImg=null,isAnimating=!1;function handleKeyboard(e){if($lightbox.is(":visible")&&!isAnimating)switch(e.key){case"Escape":e.preventDefault(),closeLightbox();break;case"ArrowLeft":e.preventDefault(),showSlide(currentIndex-1,"prev");break;case"ArrowRight":e.preventDefault(),showSlide(currentIndex+1,"next")}}function closeLightbox(){isAnimating||(isAnimating=!0,$(document).off("keydown.lightbox"),$srcImg&&$srcImg.css("opacity",1),gsap.to($lightbox,{opacity:0,duration:.3,ease:"expo.out",onComplete:()=>{$lightbox.css("display","none").css("opacity",1),$sliderItems.removeClass("active").css({opacity:0,zIndex:1}),$body.removeClass("no-scroll lightbox-open"),gsap.set($lightboxBg,{opacity:0}),gsap.set([$closeBtn,$prevBtn,$nextBtn],{scale:0}),isAnimating=!1,currentIndex=-1,$srcWrap=null,$srcImg=null,$lightboxItem=null,$lightboxImg=null}}))}function showSlide(newIndex,direction){if(isAnimating)return;isAnimating=!0;const total=$sliderItems.length;newIndex<0&&(newIndex=total-1),newIndex>=total&&(newIndex=0);const $currentItem=$sliderItems.eq(currentIndex),$nextItem=$sliderItems.eq(newIndex),$nextImg=$nextItem.find(".visual_img");let clipFrom,clipTo,moveFrom;$sliderItems.css({zIndex:1}),$nextItem.css({zIndex:3,opacity:1}).addClass("active"),$currentItem.css({zIndex:2}),"next"===direction?(clipFrom="inset(0% 0% 0% 100%)",clipTo="inset(0% 0% 0% 0%)",moveFrom=500):(clipFrom="inset(0% 100% 0% 0%)",clipTo="inset(0% 0% 0% 0%)",moveFrom=-500),gsap.set($nextItem,{clipPath:clipFrom}),gsap.set($nextImg,{x:moveFrom});const tl=gsap.timeline({defaults:{ease:"expo.out"},onComplete:()=>{$sliderItems.removeClass("active").css({opacity:0,zIndex:1}),$nextItem.addClass("active").css({opacity:1,zIndex:2}),gsap.set($nextItem,{clearProps:"clipPath"}),gsap.set($nextImg,{clearProps:"x"}),isAnimating=!1,currentIndex=newIndex}});tl.to($nextItem,{clipPath:clipTo,duration:1.2},0),tl.to($nextImg,{x:0,duration:1},0)}$listItems.on("click",function(){!function openLightbox(index,$clickedWrap){if(isAnimating)return;isAnimating=!0,currentIndex=index,$srcWrap=$clickedWrap,$srcImg=$srcWrap.find(".visual_img"),$lightboxItem=$sliderItems.eq(currentIndex),$lightboxImg=$lightboxItem.find(".visual_img"),$sliderItems.removeClass("active").css({opacity:0,zIndex:1}),$lightboxItem.addClass("active").css({opacity:1,zIndex:2}),$lightbox.css("display","block"),$body.addClass("no-scroll lightbox-open"),$(document).on("keydown.lightbox",handleKeyboard),gsap.fromTo($lightboxBg,{opacity:0},{opacity:1,duration:.8,ease:"expo.out"}),[$closeBtn,$prevBtn,$nextBtn].forEach($btn=>{gsap.fromTo($btn,{scale:0},{scale:1,duration:.6,ease:"expo.out"})});const diff=function getDiffRect(fromEl,toEl){const f=fromEl.getBoundingClientRect(),t=toEl.getBoundingClientRect();return{x:f.left-t.left,y:f.top-t.top,w:f.width,h:f.height}}($srcWrap[0],$lightboxItem[0]),popupW=$lightboxItem.outerWidth(),popupH=$lightboxItem.outerHeight();$srcImg.css("opacity",0),gsap.set($lightboxItem,{willChange:"transform,width,height,clipPath"}),gsap.fromTo($lightboxItem,{x:diff.x,y:diff.y,width:diff.w,height:diff.h},{x:0,y:0,width:popupW,height:popupH,duration:1.2,ease:"expo.out",onComplete:()=>{gsap.set($lightboxItem,{clearProps:"transform,width,height,willChange"}),isAnimating=!1}});const $title=$lightboxItem.find('[slide-info="title"]');gsap.fromTo($title,{opacity:0},{opacity:1,duration:.8,ease:"expo.in"})}($(this).index(),$(this))}),$closeBtn.on("click",function(e){e.stopPropagation(),closeLightbox()}),$nextBtn.on("click",function(e){e.stopPropagation(),showSlide(currentIndex+1,"next")}),$prevBtn.on("click",function(e){e.stopPropagation(),showSlide(currentIndex-1,"prev")})}function initArchiveThumb(scope){if(window.innerWidth<1024)return;const root=scope||document,archiveThumbs=root.querySelectorAll(".archive_thumb"),archiveTextEls=root.querySelectorAll('[data-hover="archive"]');if(!archiveThumbs.length||!archiveTextEls.length)return;const originalTexts=Array.from(archiveTextEls).map(el=>el.textContent.trim());archiveThumbs.forEach(thumb=>{thumb.addEventListener("mouseenter",()=>{archiveTextEls.forEach(el=>{el.textContent="Аrchive",gsap.fromTo(el,{opacity:0,yPercent:110},{opacity:1,yPercent:0,duration:.7,ease:"expo.out"})})}),thumb.addEventListener("mouseleave",()=>{archiveTextEls.forEach((el,index)=>{gsap.to(el,{opacity:0,yPercent:110,duration:.3,ease:"expo.in",onComplete:()=>{el.textContent=originalTexts[index],gsap.fromTo(el,{opacity:0,yPercent:110},{opacity:1,yPercent:0,duration:.5,ease:"expo.out"})}})})})}),barbaLog("Archive thumb initialized",{thumbsCount:archiveThumbs.length,textElsCount:archiveTextEls.length})}