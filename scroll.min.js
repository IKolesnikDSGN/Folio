function isMobileOrTablet(){return window.innerWidth<=1024||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function saveScrollTriggerState(e){if(isMobileOrTablet())return;const r=e||document,t=r.querySelector("#scroll");if(!t)return;const o={scrollTop:t.scrollTop,elements:{}};return r.querySelectorAll('[data-scroll="parallax-component"]').forEach((e,r)=>{if(e&&e.parentNode){const t=gsap.getProperty(e,"yPercent"),n=gsap.getProperty(e,"y");o.elements[`parallax-${r}`]={selector:'[data-scroll="parallax-component"]',index:r,yPercent:t,y:n}}}),r.querySelectorAll(".next_page_visual").forEach((e,r)=>{if(e&&e.parentNode){const t=gsap.getProperty(e,"clipPath"),n=gsap.getProperty(e,"y");o.elements[`next-visual-${r}`]={selector:".next_page_visual",index:r,clipPath:t,y:n}}),r.querySelectorAll(".divider_wrap").forEach((e,r)=>{if(e&&e.parentNode){const t=gsap.getProperty(e,"clipPath"),n=gsap.getProperty(e,"y");o.elements[`divider-${r}`]={selector:".divider_wrap",index:r,clipPath:t,y:n}}}),r.querySelectorAll(".info_wrapper").forEach((e,r)=>{if(e&&e.parentNode){const t=gsap.getProperty(e,"opacity"),n=gsap.getProperty(e,"y");o.elements[`info-wrapper-${r}`]={selector:".info_wrapper",index:r,opacity:t,y:n}}),r.querySelectorAll(".next_work-info").forEach((e,r)=>{if(e&&e.parentNode){const t=gsap.getProperty(e,"opacity"),n=gsap.getProperty(e,"y");o.elements[`next-work-info-${r}`]={selector:".next_work-info",index:r,opacity:t,y:n}}}),r.querySelectorAll(".info_divider").forEach((e,r)=>{if(e&&e.parentNode){const t=gsap.getProperty(e,"height"),n=gsap.getProperty(e,"y");o.elements[`info-divider-${r}`]={selector:".info_divider",index:r,height:t,y:n}}),window._scrollState=o,barbaLog("ScrollTrigger state saved",{scrollTop:o.scrollTop,elementsCount:Object.keys(o.elements).length}),o}function clearScrollTriggerState(){isMobileOrTablet()||window._scrollState&&(barbaLog("ScrollTrigger state cleared"),window._scrollState=null)}function initCaseSmoothScroll(e){if(isMobileOrTablet())return;const r=(e||document).querySelector("#scroll");if(!r)return;r._smoothScrollCleanup&&r._smoothScrollCleanup();let t=r.scrollTop,o=r.scrollTop,n=!1,l=null,a=!1;function i(){t+=.065*(o-t),r.scrollTop=t,window.ScrollTrigger&&ScrollTrigger.update(),Math.abs(o-t)>.5?l=requestAnimationFrame(i):(r.scrollTop=o,n=!1,l=null)}function c(){const e=r.scrollHeight-r.clientHeight;o=Math.max(0,Math.min(o,Math.max(0,e)))}function s(e){if(a)return e.preventDefault(),void e.stopPropagation();e.preventDefault(),e.stopPropagation(),o+=e.deltaY,c(),n||(n=!0,l=requestAnimationFrame(i))}function p(){c(),safeScrollTriggerRefresh()}function g(){a=!0,barbaLog("Scroll blocked for new container")}function d(){a=!1,barbaLog("Scroll unblocked for new container")}g(),setTimeout(()=>{d()},800),r.addEventListener("wheel",s,{passive:!1}),window.addEventListener("resize",p),r._smoothScrollCleanup=function(){r.removeEventListener("wheel",s),window.removeEventListener("resize",p),l&&cancelAnimationFrame(l)},r._blockScroll=g,r._unblockScroll=d}function initCaseScrollTriggers(e){if(isMobileOrTablet())return;const r=e||document,t=r.querySelector("#scroll");if(!t||!window.ScrollTrigger)return;if(t._caseSTCleanup&&t._caseSTCleanup(),window._scrollState&&window._scrollState.elements){const e=window._scrollState;t.scrollTop=e.scrollTop,Object.values(e.elements).forEach(e=>{if(e.selector&&void 0!==e.index){const t=r.querySelectorAll(e.selector)[e.index];t&&t.parentNode&&(void 0!==e.yPercent&&gsap.set(t,{yPercent:e.yPercent}),void 0!==e.y&&gsap.set(t,{y:e.y}),void 0!==e.clipPath&&gsap.set(t,{clipPath:e.clipPath}),void 0!==e.opacity&&gsap.set(t,{opacity:e.opacity}),void 0!==e.height&&gsap.set(t,{height:e.height}))}}),barbaLog("ScrollTrigger state restored",{scrollTop:e.scrollTop,elementsCount:Object.keys(e.elements).length})}const o=[],n=[],l=t._caseGlobalOnce=t._caseGlobalOnce||{};r.querySelectorAll('[data-scroll="parallax-hero"]').forEach(e=>{const l=e.querySelector('[data-scroll="parallax-component"]')||r.querySelector('[data-scroll="parallax-component"]')||document.querySelector('[data-scroll="parallax-component"]');if(!l)return;gsap.set(l,{yPercent:-30});const a=gsap.to(l,{yPercent:30,ease:"none",immediateRender:!1,scrollTrigger:{trigger:e,scroller:t,start:"top bottom",end:"bottom top",scrub:.01,invalidateOnRefresh:!0}});a&&a.scrollTrigger&&o.push(a.scrollTrigger),a&&n.push(a)}),r.querySelectorAll(".visual_container_btm").forEach(e=>{const a=e.querySelector(".next_page_visual"),i=e.querySelector(".divider_wrap")||r.querySelector(".divider_wrap")||document.querySelector(".divider_wrap"),c=e.querySelector(".info_wrapper")||r.querySelector(".info_wrapper")||document.querySelector(".info_wrapper"),s=e.querySelector(".next_work-info")||r.querySelector(".next_work-info")||document.querySelector(".next_work-info");if(a){const r=gsap.fromTo(a,{clipPath:"inset(60% 0% 0% 0%)"},{clipPath:"inset(0% 0% 0% 0%)",ease:"none",immediateRender:!1,scrollTrigger:{trigger:e,scroller:t,start:"top 50%",end:"30% top",scrub:!0}});r&&r.scrollTrigger&&o.push(r.scrollTrigger),r&&n.push(r)}if(i&&!l.divider){const r=gsap.fromTo(i,{clipPath:"inset(0% 0% 0% 0%)"},{clipPath:"inset(100% 0% 0% 0%)",ease:"none",immediateRender:!1,scrollTrigger:{trigger:e,scroller:t,start:"top 88%",end:"26% top",scrub:!0}});l.divider=!0,r&&r.scrollTrigger&&o.push(r.scrollTrigger),r&&n.push(r)}if((c||s)&&!l.infoTl){const r=gsap.timeline({defaults:{immediateRender:!1},scrollTrigger:{trigger:e,scroller:t,start:"top 50%",end:"30% top",scrub:!0}});c&&r.fromTo(c,{opacity:1},{opacity:.05,ease:"none"},0),s&&r.fromTo(s,{opacity:.1},{opacity:1,ease:"none"},0),l.infoTl=!0,r.scrollTrigger&&o.push(r.scrollTrigger),n.push(r)}let p=!1,g=!1;const d=[];e.querySelectorAll("a[href]").forEach(e=>{const r=r=>{window.location.pathname!==new URL(e.href,window.location.origin).pathname&&(g=!0,barbaLog("Link clicked in visual_container_btm - blocking automatic transition"),setTimeout(()=>{g=!1},1500))};e.addEventListener("click",r,{passive:!0}),d.push({link:e,handler:r})});const u=ScrollTrigger.create({trigger:e,scroller:t,start:"top 88%",end:"26% top",scrub:!0,onUpdate:o=>{const n=Math.round(100*o.progress),l=e.querySelectorAll('[next-page-scroll="progress"]');(l.length?l:r.querySelectorAll('[next-page-scroll="progress"]').length?r.querySelectorAll('[next-page-scroll="progress"]'):document.querySelectorAll('[next-page-scroll="progress"]')).forEach(e=>{e.textContent=n}),o.progress>=.99&&!p&&t&&"function"==typeof t._blockScroll&&(p=!0,t._blockScroll())},onLeave:()=>{const t=window.barba&&(window.barba.current&&window.barba.current.transition||document.querySelector("[data-barba-container].barba-leave")||document.querySelector("[data-barba-container].barba-enter"));if(window._barbaState.instantNavInProgress||g||window.window.archiveTransitionInProgress||t)return void barbaLog("Skipping automatic transition - user interaction or other transition in progress",{instantNavInProgress:window._barbaState.instantNavInProgress,userClickedLink:g,archiveTransitionInProgress:window.window.archiveTransitionInProgress,isBarbaTransitioning:t});const o=e.querySelector(".next_page_visual")||r.querySelector(".next_page_visual")||document.querySelector(".next_page_visual");if(o){const e=o.querySelector('[data-next="next-slug"]')||r.querySelector('[data-next="next-slug"]')||document.querySelector('[data-next="next-slug"]');if(e){const r=e.textContent.trim().toLowerCase().replace(/[\s\W_]+/g,"-").replace(/^-+|-+$/g,"");if(r){const e=`/${r}`,t=isMobileOrTablet()?"opacity-crossfade":"fade-transition";barbaLog("Triggering automatic transition via visual_container_btm",{nextPage:e,transitionType:t}),animateLeaveThenGoViaBarba(e,t)}}}}});u._linkClickHandlers=d,o.push(u)}),t._caseSTCleanup=function(){o.forEach(e=>{e&&e._linkClickHandlers&&e._linkClickHandlers.forEach(({link:e,handler:r})=>{e.removeEventListener("click",r)}),e&&e.kill()}),n.forEach(e=>{(e&&e.targets?e.targets():[]).forEach(e=>e&&gsap.set(e,{clearProps:"transform,clipPath,opacity"})),e&&e.kill()}),t._caseGlobalOnce={}},r.querySelectorAll(".info_divider").forEach(e=>{const l=gsap.fromTo(e,{height:"0%"},{height:"100%",ease:"none",immediateRender:!1,scrollTrigger:{trigger:r.querySelector('[data-progress="scroll"]')||e,scroller:t,start:"top bottom",end:"80% top",scrub:!0}});l&&l.scrollTrigger&&o.push(l.scrollTrigger),l&&n.push(l)}),r.querySelectorAll(".archive_imgs_wrap").forEach(e=>{const l=document.getElementById("archive-line"),a=document.getElementById("archive-line-wrap"),i=e.querySelectorAll('[data-scroll="number-progress"]'),c=i.length?i:r.querySelectorAll('[data-scroll="number-progress"]').length?r.querySelectorAll('[data-scroll="number-progress"]'):document.querySelectorAll('[data-scroll="number-progress"]'),s=e.querySelectorAll(".archive_img_wrap"),p=s.length*window.innerHeight;if(l){const r=gsap.fromTo(l,{width:"0%"},{width:"100%",ease:"none",immediateRender:!1,scrollTrigger:{trigger:e,scroller:t,start:"top bottom",end:`+=${p}`,scrub:!0}});r&&r.scrollTrigger&&o.push(r.scrollTrigger),r&&n.push(r)}const g=ScrollTrigger.create({trigger:e,scroller:t,start:"top bottom",end:`+=${p}`,scrub:!0,onUpdate:e=>{const r=Math.round(100*e.progress);c.forEach(e=>{e.textContent=String(r)})}});o.push(g);const d=e.querySelector('[data-scroll="archive-name"]')||r.querySelector('[data-scroll="archive-name"]')||document.querySelector('[data-scroll="archive-name"]');d&&s.length>0&&s.forEach((e,r)=>{const n=e.querySelector(".archive_img_text"),l=n?n.textContent.trim():null;if(l){const r=ScrollTrigger.create({trigger:e,scroller:t,start:"top center",end:"bottom center",onEnter:()=>{d.textContent=l,gsap.fromTo(d,{opacity:0,yPercent:110},{opacity:1,yPercent:0,duration:.5,ease:"expo.out"})},onEnterBack:()=>{d.textContent=l,gsap.fromTo(d,{opacity:0,yPercent:110},{opacity:1,yPercent:0,duration:.5,ease:"expo.out"})},onLeave:()=>{gsap.to(d,{opacity:0,yPercent:110,duration:.3,ease:"expo.in"})},onLeaveBack:()=>{gsap.to(d,{opacity:0,yPercent:110,duration:.3,ease:"expo.in"})}});o.push(r)}});let u=!1;function h(){if(u)return;u=!0,window.window.archiveTransitionInProgress=!0,t&&"function"==typeof t._blockScroll&&t._blockScroll();const o=e.querySelectorAll(".archive_progress_number")||r.querySelector(".archive_progress_number")||document.querySelector(".archive_progress_number");o&&gsap.fromTo(o,{yPercent:0},{yPercent:-130,duration:.6,ease:"expo.out"});const n=e.querySelector('[data-scroll="number-gone"]')||r.querySelector('[data-scroll="number-gone"]')||document.querySelector('[data-scroll="number-gone"]'),l=e.id||"",i=`/${l.startsWith("next--")?l.replace("next--",""):l}`,c=gsap.timeline({onComplete:()=>{if(window.window.archiveTransitionInProgress&&i&&"/"!==i)if(window.barba&&"function"==typeof barba.go){const e=document.createElement("a");e.href=i,e.setAttribute("data-barba-link","fade"),e.style.display="none",document.body.appendChild(e),e.click(),setTimeout(()=>{document.body.removeChild(e)},100)}else window.location.href=i}});if(c.to({},{duration:.5}),a){c.addLabel("start");c.fromTo(a,{clipPath:"inset(0% 0% 0% 0%)"},{clipPath:"inset(0% 0% 0% 100%)",duration:1,ease:"expo.Out"},"start");if(n){let e=2;n.textContent=String(e);const r=setInterval(()=>{e-=1,e<=0?(n.textContent="0",clearInterval(r)):n.textContent=String(e)},1e3);c.eventCallback("onComplete",()=>{try{clearInterval(r)}catch(e){}})}}else if(n){let e=2;n.textContent=String(e);const r=setInterval(()=>{e-=1,n.textContent=String(Math.max(e,0)),e<=0&&clearInterval(r)},1e3);gsap.delayedCall(3,()=>{try{clearInterval(r)}catch(e){}window.archiveTransitionInProgress&&i&&"/"!==i&&animateLeaveThenGoViaBarba(i,"fade-transition")})}else gsap.delayedCall(1,()=>{window.archiveTransitionInProgress&&i&&"/"!==i&&animateLeaveThenGoViaBarba(i,"fade-transition")});c.play(),gsap.delayedCall(1.25,()=>{if(window.archiveTransitionInProgress&&i&&"/"!==i)if(window.barba&&"function"==typeof barba.go){const e=document.createElement("a");e.href=i,e.setAttribute("data-barba-link","fade"),e.style.display="none",document.body.appendChild(e),e.click(),setTimeout(()=>{document.body.removeChild(e)},100)}else window.location.href=i})}const y=ScrollTrigger.create({trigger:e,scroller:t,start:"bottom bottom",end:"bottom bottom",onEnter:()=>{h()},onUpdate:e=>{e.progress>=.99&&h()}}),m=ScrollTrigger.create({trigger:e,scroller:t,start:"top bottom",end:`+=${p}`,onUpdate:e=>{e.progress>=.99&&h()}});o.push(m),o.push(y)}),safeScrollTriggerRefresh(),setTimeout(()=>safeScrollTriggerRefresh(),0)}function cleanupCaseScrollFeatures(e){if(isMobileOrTablet())return;const r=(e||document).querySelector("#scroll");if(!r)return;barbaLog("Cleaning up scroll features",{hasScroll:!!r}),r._smoothScrollCleanup&&(r._smoothScrollCleanup(),r._smoothScrollCleanup=null),r._caseSTCleanup&&(r._caseSTCleanup(),r._caseSTCleanup=null);r.querySelectorAll("[data-scroll], .visual_container_btm, .info_divider").forEach(e=>{gsap.killTweensOf(e)})}
